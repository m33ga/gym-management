<Page
    x:Class="GymManagement.UWP.Views.Profile.ProfilePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:GymManagement.UWP.Views.Profile"
    xmlns:viewModels="using:GymManagement.UWP.ViewModels"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
    xmlns:converters="using:GymManagement.UWP.Converters">

    <Page.Resources>
        <ResourceDictionary>
            <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>

            <Style x:Key="BaseGridStyle" TargetType="Grid">
                <Setter Property="Background" Value="#F9F9F9" />
            </Style>

            <Style TargetType="NavigationViewItem">
                <Setter Property="Foreground" Value="Gray" />
                <Setter Property="Background" Value="Transparent" />
            </Style>
        </ResourceDictionary>
    </Page.Resources>




    <Grid>
        <NavigationView x:Name="nvMain"
                IsSettingsVisible="False"
                IsBackButtonVisible="Collapsed"
                ItemInvoked="NvMain_OnItemInvoked"
                PaneDisplayMode="LeftCompact"
                IsPaneToggleButtonVisible="{Binding IsPaneOpen, Mode=TwoWay}"
                Foreground="Black">

            <!-- VisualStateManager for dynamic UI changes based on user role is here -->

            <NavigationView.Resources>
                <SolidColorBrush x:Key="NavigationViewDefaultPaneBackground" Color="White" />
            </NavigationView.Resources>

            <!-- NavigationView.MenuItems structure -->
            <NavigationView.MenuItems>
                <NavigationViewItem x:Name="nvProfile"
                                    Visibility="{x:Bind ViewModel.IsProfileComplete, Mode=OneWay}"
                                    Tag="profile">
                    <NavigationViewItem.ContentTemplate>
                        <DataTemplate>
                            <Grid HorizontalAlignment="Center" VerticalAlignment="Center" Width="20" Height="20">
                                <Ellipse Fill="White" />
                                <Image Source="ms-appx:///Assets/image.png"
                                       Stretch="UniformToFill" />
                            </Grid>
                        </DataTemplate>
                    </NavigationViewItem.ContentTemplate>
                </NavigationViewItem>

                <NavigationViewItem x:Name="nvNotifications"
                                    Visibility="{x:Bind ViewModel.IsProfileComplete, Mode=OneWay}"
                                    Tag="notifications">
                    <NavigationViewItem.Icon>
                        <BitmapIcon UriSource="ms-appx:///Assets/Notification.png" />
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem x:Name="nvDashboard"
                                    Visibility="{x:Bind ViewModel.IsProfileComplete, Mode=OneWay}"
                                    Tag="dashboard">
                    <NavigationViewItem.Icon>
                        <BitmapIcon UriSource="ms-appx:///Assets/Shortlist.png"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem x:Name="nvSchedule"
                                    Visibility="{x:Bind ViewModel.IsProfileComplete, Mode=OneWay}"
                                    Tag="schedule">
                    <NavigationViewItem.Icon>
                        <BitmapIcon UriSource="ms-appx:///Assets/Schedule.png"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>

                <NavigationViewItem x:Name="nvMealplan"
                                    Visibility="{x:Bind ViewModel.IsProfileComplete, Mode=OneWay}"
                                    Tag="meal_plan">
                    <NavigationViewItem.Icon>
                        <BitmapIcon UriSource="ms-appx:///Assets/Restaurant.png"/>
                    </NavigationViewItem.Icon>
                </NavigationViewItem>
            </NavigationView.MenuItems>

            <NavigationView.PaneFooter>
                <StackPanel>
                    <NavigationViewItem x:Name="nvLogout"
                                        Visibility="{x:Bind ViewModel.IsProfileComplete, Mode=OneWay}"
                                        Icon="NewWindow"
                                        Tapped="NvLogout_OnTapped"/>
                </StackPanel>
            </NavigationView.PaneFooter>

            <!-- Main Content Area -->
            <Frame x:Name="frmMain" Padding="40, 40" Background="#F5F5F5">
                <Border Background="White" 
                    CornerRadius="20"
                    Padding="40">
                    <Grid>
                        <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <!-- Header -->
                        <RowDefinition Height="*"/>
                        <!-- Content -->
                        <RowDefinition Height="Auto"/>
                        <!-- Footer -->
                    </Grid.RowDefinitions>

                    <!-- Profile Header with WinUI 2.x -->
                    <StackPanel Grid.Row="0"
                                Orientation="Horizontal"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Center"
                                Margin="20">
                        <PersonPicture Width="100"
                                       Height="100"
                                       ProfilePicture="{Binding ProfilePictureUri}"
                                       DisplayName="{Binding FullName}"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"
                                       CornerRadius="50"/>  

                        <StackPanel Margin="20,0,0,0">
                                <TextBlock Text="{Binding FullName}"
                                           FontSize="26"
                                           FontWeight="Bold"
                                           Foreground="Black"/>     
                                <TextBlock Text="{Binding Email}"
                                           FontSize="16"
                                           Foreground="Gray"
                                           Margin="0,5,0,0"/>
                            </StackPanel>
                            <Button Content="Edit"
                                    HorizontalAlignment="Right"
                                    Margin="10" Padding="10"
                                    VerticalAlignment="Center"/>
                    </StackPanel>


                    <!-- Dynamic Content Based on User Role -->
                    <StackPanel Grid.Row="1" 
                                Visibility="{Binding IsMember, Converter={StaticResource BoolToVisibilityConverter}}">
                        <!-- Member Specific Details -->
                        <TextBlock Text="Member View"/>
                    </StackPanel>

                    <StackPanel Grid.Row="1" 
                                Visibility="{Binding IsTrainer, Converter={StaticResource BoolToVisibilityConverter}}">
                        <!-- Trainer Specific Details -->
                        <TextBlock Text="Trainer View"/>
                    </StackPanel>

                    <!-- Additional Info/Footer -->
                    <StackPanel Grid.Row="2" HorizontalAlignment="Center">
                        <TextBlock Text="Footer Info" FontSize="14"/>
                    </StackPanel>
                </Grid>
                </Border>
            </Frame>

        </NavigationView>
    </Grid>
</Page>